# 알림 시스템 UI 테스트 시나리오

MandaAct 알림 시스템의 모든 메시지를 직접 확인하기 위한 테스트 가이드입니다.

## 📋 목차

1. [테스트 준비](#테스트-준비)
2. [Toast 알림 테스트](#toast-알림-테스트)
3. [PWA Push 알림 테스트](#pwa-push-알림-테스트)
4. [확인 다이얼로그 테스트](#확인-다이얼로그-테스트)
5. [체크리스트](#체크리스트)

---

## 테스트 준비

### 개발 서버 실행
```bash
npm run dev
# http://localhost:5173 접속
```

### 테스트 계정 준비
1. 기존 계정으로 로그인 OR
2. 새 테스트 계정 생성 (test@example.com)
3. 최소 1개 이상의 만다라트 생성 권장

### 브라우저 개발자 도구 활용
- **콘솔 확인**: 에러 메시지 확인
- **Network 탭**: API 요청 실패 확인
- **Application 탭**: PWA 알림 권한 상태 확인

---

## Toast 알림 테스트

Toast 알림은 화면 우측 상단(모바일: 하단)에 나타나는 메시지입니다.

### 1. 알림 설정 페이지 (`/settings/notifications`)

**테스트 위치**: 상단 네비게이션 → 더보기 → 알림 설정

#### 1-1. 권한 허용 성공 ✅
**시나리오**:
1. 알림 설정 페이지 접속
2. "알림 권한 요청" 버튼 클릭
3. 브라우저 팝업에서 "허용" 클릭

**예상 결과**:
```
제목: ✅ 권한 허용
내용: 알림을 받으실 수 있습니다.
지속시간: 3초
```

#### 1-2. 권한 거부 ⚠️
**시나리오**:
1. 알림 설정 페이지 접속
2. "알림 권한 요청" 버튼 클릭
3. 브라우저 팝업에서 "차단" 클릭

**예상 결과**:
```
제목: ⚠️ 권한 거부
내용: 브라우저 설정에서 알림 권한을 허용해주세요.
variant: destructive (빨간색)
지속시간: 3초
```

#### 1-3. 알림 설정 저장 성공 ✅
**시나리오**:
1. 알림 권한 허용 상태에서
2. 알림 시간 변경 (예: 09:00 → 10:00)
3. "설정 저장" 버튼 클릭

**예상 결과**:
```
제목: ✅ 저장 완료
내용: 설정이 저장되었습니다.
지속시간: 3초
```

#### 1-4. 알림 테스트 발송 성공 ✅
**시나리오**:
1. 알림 권한 허용 상태에서
2. "알림 테스트" 버튼 클릭

**예상 결과**:
```
제목: ✅ 알림 발송
내용: 테스트 알림이 발송되었습니다.
지속시간: 3초
```

**추가 확인**: 시스템 알림으로 "MandaAct 알림 테스트" 표시되는지 확인

#### 1-5. 알림 테스트 실패 ❌
**시나리오**:
1. 알림 권한 거부 상태에서
2. "알림 테스트" 버튼 클릭

**예상 결과**:
```
제목: ❌ 알림 실패
내용: 알림 권한이 필요합니다.
variant: destructive (빨간색)
지속시간: 3초
```

#### 1-6. 알림 미지원 브라우저 ⚠️
**시나리오**:
- 알림 미지원 브라우저에서 페이지 접속 (테스트 어려움, 참고만)

**예상 결과**:
```
제목: ⚠️ 미지원 브라우저
내용: 이 브라우저는 알림을 지원하지 않습니다.
variant: destructive (빨간색)
지속시간: 3초
```

#### 1-7. 알림 설정 저장 실패 ❌
**시나리오** (의도적 실패 테스트):
- 개발자 도구 Network 탭에서 localStorage 비활성화하거나
- Supabase 연결 끊은 상태에서 저장 시도

**예상 결과**:
```
제목: ❌ 저장 실패
내용: 설정 저장 중 오류가 발생했습니다.
variant: destructive (빨간색)
지속시간: 3초
```

---

### 2. 만다라트 상세 페이지 (`/mandalart/:id`)

**테스트 위치**: 만다라트 관리 → 특정 만다라트 클릭

#### 2-1. 핵심 목표 수정 성공 ✅
**시나리오**:
1. 상세 페이지에서 중앙 셀 클릭
2. 핵심 목표 제목 수정
3. ✓ (체크) 버튼 클릭

**예상 결과**:
```
제목: ✅ 업데이트 완료
내용: 변경사항이 저장되었습니다.
지속시간: 3초
```

#### 2-2. 세부 목표 수정 성공 ✅
**시나리오**:
1. 상세 페이지에서 주변 8개 셀 중 하나 클릭
2. 세부 목표 제목 수정
3. ✓ (체크) 버튼 클릭

**예상 결과**:
```
제목: ✅ 업데이트 완료
내용: 변경사항이 저장되었습니다.
지속시간: 3초
```

#### 2-3. 실천항목 제목 수정 성공 ✅
**시나리오**:
1. 세부 목표 클릭 → 모달 열림
2. 하단 실천항목 리스트에서 항목 클릭
3. 제목 수정 후 ✓ (체크) 버튼 클릭

**예상 결과**:
```
제목: ✅ 업데이트 완료
내용: 변경사항이 저장되었습니다.
지속시간: 3초
```

#### 2-4. 실천항목 타입 변경 성공 ✅
**시나리오**:
1. 세부 목표 클릭 → 모달 열림
2. 실천항목의 타입 배지 클릭 (루틴/미션/참고)
3. 다른 타입 선택 후 "적용" 버튼 클릭

**예상 결과**:
```
제목: ✅ 타입 변경
내용: 실천항목 타입이 업데이트되었습니다.
지속시간: 3초
```

#### 2-5. 만다라트 비활성화 성공 ✅
**시나리오**:
1. 상세 페이지 우측 상단 "⋮" 메뉴 클릭
2. "삭제" 클릭
3. AlertDialog에서 "비활성화 (권장)" 버튼 클릭

**예상 결과**:
```
제목: ✅ 비활성화 완료
내용: 만다라트가 비활성화되었습니다.
지속시간: 3초
```

**추가 확인**: 만다라트 목록에서 해당 항목 미표시 확인

#### 2-6. 만다라트 영구 삭제 성공 ✅
**시나리오**:
1. 상세 페이지 우측 상단 "⋮" 메뉴 클릭
2. "삭제" 클릭
3. AlertDialog에서 "영구 삭제" 버튼 클릭
4. 2단계 확인 대화상자에서 "영구 삭제 확정" 버튼 클릭

**예상 결과**:
```
제목: ✅ 삭제 완료
내용: 만다라트가 삭제되었습니다.
지속시간: 3초
```

**추가 확인**: 데이터베이스에서 완전 삭제 확인

#### 2-7. 만다라트 활성화 성공 ✅
**시나리오**:
1. 비활성화된 만다라트 상세 페이지 접속 (URL 직접 입력 필요)
2. "활성화" 버튼 클릭

**예상 결과**:
```
제목: ✅ 활성화 완료
내용: 만다라트가 활성화되었습니다.
지속시간: 3초
```

#### 2-8. 삭제/수정 실패 ❌
**시나리오** (의도적 실패):
- Network 탭에서 Supabase 요청 차단
- 삭제 또는 수정 시도

**예상 결과**:
```
제목: ❌ 작업 실패
내용: [구체적 오류 메시지]
variant: destructive (빨간색)
지속시간: 3초
```

---

### 3. 오늘의 실천 페이지 (`/today`)

**테스트 위치**: 상단 네비게이션 → 오늘의 실천

#### 3-1. 실천항목 타입 변경 성공 ✅
**시나리오**:
1. 오늘의 실천 페이지에서 항목의 타입 배지 클릭
2. 다른 타입 선택 후 "적용" 버튼 클릭

**예상 결과**:
```
제목: ✅ 타입 변경
내용: 실천항목 타입이 업데이트되었습니다.
지속시간: 3초
```

---

### 4. 사용자 프로필 카드 (`/stats`)

**테스트 위치**: 상단 네비게이션 → 진행상황

#### 4-1. 닉네임 변경 성공 ✅
**시나리오**:
1. 진행상황 페이지 상단 프로필 카드에서 닉네임 옆 편집 아이콘 클릭
2. 새 닉네임 입력
3. "저장" 버튼 클릭

**예상 결과**:
```
제목: ✅ 닉네임 변경
내용: 닉네임이 업데이트되었습니다.
지속시간: 3초
```

---

## PWA Push 알림 테스트

PWA Push 알림은 브라우저/시스템 레벨에서 표시되는 알림입니다.

### 1. 테스트 알림

**시나리오**:
1. 알림 설정 페이지에서 권한 허용
2. "알림 테스트" 버튼 클릭

**예상 결과 (시스템 알림)**:
```
제목: MandaAct 알림 테스트
내용: 알림 테스트에 성공했습니다.
아이콘: /pwa-192x192.png (MandaAct 로고)
```

**확인 방법**:
- Windows: 우측 하단 알림 센터
- macOS: 우측 상단 알림 센터
- Android: 상단 알림바
- iOS: 상단 알림 (Safari PWA만 지원)

### 2. 일일 리마인더 알림

**시나리오**:
1. 알림 설정 페이지에서 권한 허용
2. 알림 시간 설정 (예: 현재 시간 + 1분 후)
3. 알림 활성화 토글 ON
4. "설정 저장" 버튼 클릭
5. 설정한 시간까지 대기 (브라우저/앱을 백그라운드에서 유지)

**예상 결과 (3가지 패턴 중 무작위)**:

**패턴 1**: 목표 중심 메시지
```
제목: MandaAct
내용: "{핵심 목표}" 향해 오늘도 한 걸음 나아가세요.
(핵심 목표 없으면: 오늘의 실천 항목을 확인해보세요.)
아이콘: /pwa-192x192.png
```

**패턴 2**: 실천 격려 메시지
```
제목: 실천 시간
내용: 어제 {n}개 완료하셨습니다. 오늘도 함께해요.
(어제 기록 없으면: 작은 실천이 큰 변화를 만듭니다.)
아이콘: /pwa-192x192.png
```

**패턴 3**: 항목 안내 메시지
```
제목: 목표를 향한 하루
내용: {n}개의 실천 항목이 기다리고 있습니다.
(항목 없으면: 오늘도 꾸준히 실천해보세요.)
아이콘: /pwa-192x192.png
```

**⚠️ 중요 제약사항**:
- 브라우저를 완전히 종료하면 알림이 발송되지 않습니다.
- 백그라운드에서 앱/탭을 유지해야 합니다.
- setTimeout 기반 구현의 한계입니다.

---

## 확인 다이얼로그 테스트

### 1. AlertDialog (2단계 확인) - 만다라트 삭제

**테스트 위치**: 만다라트 상세 페이지 → ⋮ 메뉴 → 삭제

#### 1단계: 선택 대화상자
**시나리오**:
1. 삭제 버튼 클릭
2. AlertDialog 표시 확인

**예상 UI**:
```
제목: 만다라트 삭제

내용:
이 만다라트를 어떻게 처리하시겠습니까?

비활성화 (권장)
• 목록에서 숨김 처리됩니다.
• 데이터는 보관되어 언제든 다시 활성화할 수 있습니다.
• 기록이 유지되어 통계에 반영됩니다.

영구 삭제
• 모든 데이터가 완전히 삭제됩니다.
• 삭제된 데이터:
  - 세부 목표: {n}개
  - 실천 항목: {n}개
  - 체크 기록: {n}개
• 이 작업은 되돌릴 수 없습니다.

버튼: [취소] [비활성화 (권장)] [영구 삭제]
```

#### 2단계: 최종 확인 대화상자 (영구 삭제 선택 시)
**시나리오**:
1. "영구 삭제" 버튼 클릭
2. 2단계 확인 대화상자 표시

**예상 UI**:
```
제목: 영구 삭제 확인

내용:
정말로 이 만다라트를 영구적으로 삭제하시겠습니까?

이 작업은 되돌릴 수 없으며, 다음 데이터가 모두 삭제됩니다:
• 세부 목표: {n}개
• 실천 항목: {n}개
• 체크 기록: {n}개

버튼: [뒤로] [영구 삭제 확정]
```

**확인 항목**:
- [ ] 1단계에서 통계 수치가 정확하게 표시되는가?
- [ ] "비활성화 (권장)" 버튼이 시각적으로 강조되는가?
- [ ] "영구 삭제" 버튼이 빨간색(destructive)으로 표시되는가?
- [ ] 2단계로 진입 시 "뒤로" 버튼이 작동하는가?
- [ ] 최종 확정 시 Toast 알림이 표시되는가?

### 2. confirm() 다이얼로그 - 실천항목 삭제

**테스트 위치 1**: 만다라트 상세 페이지 → 세부 목표 클릭 → 실천항목 삭제 아이콘

**테스트 위치 2**: 세부 목표 생성 모달 → 실천항목 삭제 아이콘

**시나리오**:
1. 실천항목 삭제 아이콘 클릭 (🗑️ 또는 X)
2. 브라우저 confirm 대화상자 표시

**예상 UI**:
```
실천항목을 삭제하시겠습니까?
삭제된 데이터는 복구할 수 없습니다.

버튼: [취소] [확인]
```

**확인 항목**:
- [ ] 메시지가 2줄로 표시되는가?
- [ ] "확인" 클릭 시 항목이 삭제되는가?
- [ ] "취소" 클릭 시 아무 일도 일어나지 않는가?

---

## 체크리스트

### ✅ Toast 알림 (총 15개)

#### 알림 설정 페이지 (7개)
- [ ] ✅ 권한 허용
- [ ] ⚠️ 권한 거부
- [ ] ✅ 저장 완료
- [ ] ❌ 저장 실패
- [ ] ✅ 알림 발송 (테스트 성공)
- [ ] ❌ 알림 실패 (테스트 실패)
- [ ] ⚠️ 미지원 브라우저

#### 만다라트 상세 페이지 (8개)
- [ ] ✅ 업데이트 완료 (핵심 목표 수정)
- [ ] ✅ 업데이트 완료 (세부 목표 수정)
- [ ] ✅ 업데이트 완료 (실천항목 제목 수정)
- [ ] ✅ 타입 변경 (실천항목 타입 변경)
- [ ] ✅ 비활성화 완료
- [ ] ✅ 영구 삭제 완료
- [ ] ✅ 활성화 완료
- [ ] ❌ 작업 실패 (의도적 오류)

#### 오늘의 실천 페이지 (1개)
- [ ] ✅ 타입 변경

#### 사용자 프로필 (1개)
- [ ] ✅ 닉네임 변경

### 🔔 PWA Push 알림 (총 4개)

- [ ] 테스트 알림 (기본)
- [ ] 일일 리마인더 - 패턴 1 (목표 중심)
- [ ] 일일 리마인더 - 패턴 2 (실천 격려)
- [ ] 일일 리마인더 - 패턴 3 (항목 안내)

### 💬 확인 다이얼로그 (총 2개)

- [ ] AlertDialog - 만다라트 삭제 (2단계)
- [ ] confirm() - 실천항목 삭제

---

## 테스트 팁

### 1. 여러 알림 동시 테스트
**목적**: 스택 제한(최대 3개) 확인

**방법**:
1. 빠르게 여러 작업 수행 (예: 여러 항목 수정)
2. 화면에 최대 3개까지만 표시되는지 확인
3. 5초 후 자동으로 사라지는지 확인

### 2. 에러 상황 강제 발생
**목적**: 오류 메시지 테스트

**방법**:
1. 개발자 도구 → Network 탭 → Offline 모드 활성화
2. 저장/수정/삭제 작업 수행
3. 오류 Toast가 빨간색으로 표시되는지 확인

### 3. 모바일 환경 테스트
**목적**: 반응형 UI 확인

**방법**:
1. 개발자 도구 → 디바이스 툴바 (Ctrl+Shift+M)
2. iPhone/Android 프리셋 선택
3. Toast가 화면 하단에 표시되는지 확인

### 4. 다크 모드 테스트
**목적**: 다크 모드 가독성 확인

**방법**:
1. 시스템 다크 모드 활성화
2. 알림 색상이 적절한지 확인
3. 특히 destructive variant 가독성 확인

### 5. 스크린샷 캡처
**목적**: 문서화 및 공유

**방법**:
1. 각 알림 표시 시 스크린샷 캡처
2. 파일명: `toast_권한허용.png`, `alert_삭제확인.png` 등
3. `claudedocs/screenshots/` 디렉토리에 저장 권장

---

## 문제 발생 시 체크포인트

### Toast 알림이 표시되지 않는 경우
1. [ ] `src/components/ui/toaster.tsx` 컴포넌트가 App.tsx에 포함되어 있는가?
2. [ ] 브라우저 콘솔에 에러가 있는가?
3. [ ] `showSuccess()` / `showError()` 함수가 올바르게 호출되는가?

### PWA 알림이 작동하지 않는 경우
1. [ ] 브라우저가 알림을 지원하는가? (Safari는 제한적)
2. [ ] 권한이 "granted" 상태인가? (Application 탭 확인)
3. [ ] Service Worker가 등록되어 있는가?
4. [ ] HTTPS 또는 localhost에서 테스트하고 있는가?

### AlertDialog가 표시되지 않는 경우
1. [ ] `@/components/ui/alert-dialog` 컴포넌트가 설치되어 있는가?
2. [ ] `deleteDialogOpen` 상태가 true로 변경되는가? (React DevTools 확인)
3. [ ] CSS 오버레이가 z-index 충돌을 일으키지 않는가?

---

**문서 버전**: 1.0
**작성일**: 2025-11-10
**테스트 대상**: Notification System v2.0
**예상 테스트 시간**: 30-45분 (전체 시나리오)
